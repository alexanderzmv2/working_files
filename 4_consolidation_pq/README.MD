# Отчет, объединяющий данные из множества файлов определенной структуры в один массив с последующей обработкой.
# [Архив](https://github.com/alexanderzmv2/working_files/raw/main/4_consolidation_pq/4_consolidation.7z) можно распаковать в любом месте на диске. Содержание архива и его описание ниже в таблице.
| Папка архива | Описание | Стек технологий | Дополнительно | 
| :---------------------- | :---------------------- | :---------------------- | :---------------------- |
| Dashboard | В папке содержится дашбород с графиками и табличными данными, на основе заполенных файлов из паки "Шаблоны" | `Excel`,`VBA`,`MS PowerQuery` | Отчет обновляется при запуске файла с помощью PowerQuery, а также вручную, если отчет уже открыт, для этого необходимо нажать на текст "Обновлено на: " в правом верхнем углу. Для сбора данных была разработана универсальная функция в PowerQuery. |
| Выгрузки SAP | Данные по затратам из SAP для дашборда | `Excel` | |
| Справочники | Файлы со справочниками, которые используются в качестве мэппинга и для выпадающих список в файлах шаблонов | `Excel` | |
| Шаблоны | Файлы шаблонов в разбивке по филиалам. Заполнение таблицы полуавтоматическое, столбцы содержащие символ "↓" заполняются через форму со списком, для этого в ячейке этого столбца нажимается дважды мышкой и открывается перечень аналитик, которые загружаются из файлов справочников.  | `Excel`,`VBA`,`MS PowerQuery` | Форма со списком организована с помощью выполнения запросов SQL через OLEDB подключение внутри книги к умным таблицам (smart tables), которые формируются из запроса PowerQuery к справочникам. Также в таблице заполнения используется множество проверок через условное форматирование (н-р некорректный формат данных) и оформление таблицы в целом (заливка, границы) |
